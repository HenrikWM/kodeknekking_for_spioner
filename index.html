<!DOCTYPE html>
<html lang="nb">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Kodeknekking for spioner - JavaZone 2019</title>

    <meta
      name="description"
      content="Kodeknekking for spioner - JavaZone 2019"
    />
    <meta name="author" content="Henrik Walker Moe" />

    <meta
      name="viewport"
      content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <meta
      property="og:title"
      content="Kodeknekking for spioner - JavaZone 2019"
    />
    <meta
      property="og:description"
      content="En gjennomgang av løsningen på PST-gåten presentert på JavaZone 2019"
    />
    <meta property="og:site_name" content="Github" />
    <meta
      property="og:image"
      content="https://henrikwm.github.io/kodeknekking_for_spioner/img/twitterhai-eu/twitterhai-eu_1337_shrk.jpg"
    />
    <meta property="og:type" content="article" />
    <meta
      property="og:url"
      content="https://henrikwm.github.io/kodeknekking_for_spioner"
    />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@github" />
    <meta name="twitter:creator" content="@henrikwm" />
    <meta
      name="twitter:title"
      content="Kodeknekking for spioner - JavaZone 2019"
    />
    <meta
      name="twitter:description"
      content="En gjennomgang av løsningen på PST-gåten presentert på JavaZone 2019"
    />
    <meta
      name="twitter:image"
      content="https://henrikwm.github.io/kodeknekking_for_spioner/img/twitterhai-eu/twitterhai-eu_1337_shrk.jpg"
    />

    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="msapplication-tap-highlight" content="no" />

    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/reveal.min.css" />
    <link rel="stylesheet" href="css/theme/black.css" id="theme" />
    <link rel="stylesheet" href="css/custom.css" />

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css" />

    <!-- Title-Footer plugin -->
    <link rel="stylesheet" href="plugin/title-footer/title-footer.css" />
    <link rel="stylesheet" href="plugin/title-footer/title-footer-custom.css" />

    <!-- Globals -->
    <script type="text/javascript" async defer>
      var isProd = true;
      var defaultFooterText = "Kodeknekking for spioner - JavaZone 2019";
    </script>

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement("link");
      link.rel = "stylesheet";
      link.type = "text/css";
      link.href = window.location.search.match(/print-pdf/gi)
        ? "css/print/pdf.css"
        : "css/print/paper.css";
      document.getElementsByTagName("head")[0].appendChild(link);
    </script>

    <!-- Scrambler -->
    <script src="lib/js/scrambler.min.js"></script>

    <!-- QR Codes -->
    <script type="text/javascript" src="lib/js/qrcode.min.js"></script>

    <!--[if lt IE 9]>
      <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <!-- =================== START =================== -->
        <section>
          <section data-source="background_image">
            <p>
              <span class="fragment">henrikwm</span>
              <span class="fragment">@</span>
              <span class="fragment">bekk</span>
            </p>
            <aside class="notes">
              Heisann alle sammen! Og takk for at dere kom for å høre på meg
              idag! Setter stor pris på at så mange av dere stiller opp på
              dagens siste foredrag.<br />
              (NESTE)<br />
              Mitt navn er Henrik Walker Moe og (NESTE) jeg jobber i (NESTE)<br />
              Bekk.<br /><br />
              Og idag skal jeg snakke om...
            </aside>
          </section>

          <section data-transition="concave" data-source="bitmoji">
            <div>
              <h2>Kodeknekking for spioner</h2>
              <img src="img/intro/intro_spy_avatar.png" class="plain" />
            </div>
            <aside class="notes">
              <b>Kodeknekking for spioner</b><br />
              * Hvordan var mitt første møte med kodeknekking
            </aside>
          </section>
        </section>

        <!-- =================== INTRO =================== -->
        <section>
          <section data-source="skattejakten_bokelskere">
            <img
              src="img/intro/intro-skattejakten.jpeg"
              class="plain"
              style="width: 40%"
            />
            <aside class="notes">
              * I 1999 kjøpte foreldrene mine denne boken av Margit Sandemo:
              Skattejakten<br />
              * Roman fylt med gåter, leder til en begravd skatt i Norge
              (skatten er funnet)<br />
              * Hele familien leste igjennom boken og fordelte oppgaver<br />
              * For min del: selvstudie i Kalevala (Finlands nasjonalepos) og
              myten om den greske guden Pan (han som er geit fra livet ned og
              spiller fløyte)<br />
              * Hvordan prøvde vi å løse gåten? (programmering)<br /><br />

              Tanken at programmeringskunnskaper kan bidra til å løse
              hverdagsutfordringer tror jeg inspirerte meg til å senere bli en
              <b>utvikler</b> og <b>kodeknekker</b>
            </aside>
          </section>

          <section>
            <h3>Hvem er jeg?</h3>
            <aside class="notes">
              Så noen raske ord om meg
            </aside>
          </section>

          <section
            data-background="img/intro/intro_henrik_ecotrail.JPG"
            data-source="henrikwm"
          >
            <aside class="notes">
              Jeg...<br />
              * liker å løpe, noen ganger langt. Her fra Ecotrail i mai<br />
              * er sta, har pågangsmot <br />
              * liker utfordringer med klare mål<br /><br />

              Dette er egenskaper tilfeldigvis også egner seg veldig godt til
              kodeknekking
            </aside>
          </section>

          <section
            data-background="img/intro/intro_henrik_nnug.jpg"
            data-source="henrikwm"
          >
            <aside class="notes">
              Jeg...<br />
              * er med i NNUG-styret (Norwegian .NET User Group)<br />
              * og bidrar bl.a. med å arrangere våre NNUG-meetups<br />
              * er med på å arrangere Microsofts årlige Global Azure
              Bootcamp-meetup her i Oslo, hvor vi bruker en hel dag på å lære
              masse om sky og Azure<br /><br />

              I Bekk har vi faggrupper<br />
              * Hvilke faggrupper har jeg deltatt i? (2 år i Sikkerhet,
              faggruppeleder iår i Open Source)<br /><br />

              (ANEKDOTE):<br />
              Appropos sikkeret: holdt foredrag på JavaZone i forfjor og snakket
              om hvordan lage sømløse innloggingsløsninger - tydelig at
              sikkerhet har blitt et fagområde jeg trives i
            </aside>
          </section>

          <section>
            <h3>I ❤️ CTF-er</h3>
            <aside class="notes">
              Og jeg digger CTF-er!<br />
              * Min favoritt kompetanseaktivitet om dagen<br />
              * Hva er en CTF? (en nøtt, hacke seg igjennom sårbarheter og finne
              en skjult kode)<br />
              * Hvorfor liker jeg CTF'er? (måldrevet, må analysere, etterforske
              og forstå før man kan hacke, belønning)<br /><br />

              * PST-gåten viste seg å være en stor CTF, så jeg ble ganske gira!
              Gleder meg til å ta dere igjennom løsningen straks<br /><br />

              PST søkte etter flere folk, hvorfor?
            </aside>
          </section>

          <section>
            <h3>Mangel på hackere/spioner i PST?</h3>
            <p class="fragment">
              Vi må møte en økende trussel for dataangrep mot Norge og norske
              interesser.
            </p>
            <span class="fragment">
              <p>Store mediesaker i 2019:</p>
              <a
                href="https://e24.no/naeringsliv/i/rLx3lR/kina-anklages-for-aa-hacke-visma-i-norge"
                >Kina anklages for å hacke Visma</a
              >
            </span>

            <br />
            <a
              class="fragment"
              href="https://www.dn.no/marked/bitcoins-norge/bitcoin/bitcoins-norway/norsk-kryptobors-reklamerte-med-hacke-forsikring-if-avviser-at-de-dekker-kundenes-bitcoin-tap/2-1-631326"
              >Bitcoin Norge hevder å ha bli hacket</a
            >
            <aside class="notes">
              Hvorfor ser Politiets Sikkerhetstjeneste etter flere
              etterforskere, eller spioner? (NESTE)<br /><br />

              * Jeg tror de ser at trusselen for dataangrep øker, både nasjonalt
              og internasjonalt (NESTE)<br />
              ** Kina hacket Visma (NESTE)<br />
              ** Bitcoin Norge hacket<br /><br />

              * For å forsvare oss trenger vi styrke hos PST, Norges Sikkerhets
              Myndighet (NSM) og E-tjenesten.<br />

              * Jeg skjønner at dere tenker "hva er <b>sannsynligheten</b> for
              hacking mot Norge?" og "dette skjer jo ikke i <b>lille Norge</b>"
              osv. Hva er vitsen med å bruke masse ressurser på dette når det er
              så mye det offentlige heller burde bruke penger på<br /><br />

              Det er en sak til som jeg ikke har nevnt...
            </aside>
          </section>

          <section>
            <h3>Dataangrep mot Hydro</h3>
            <aside class="notes">Denne svei</aside>
          </section>

          <section data-source="abcnyheter_hydro">
            <img
              src="img/intro/intro-abcnyheter-hydro.png"
              class="plain"
              style="width: 60%"
            />
            <aside class="notes">
              19. mars i våres ble Hydro angrepet av et krypteringsvirus
              ("LockerGoga").<br /><br />
              Dette skjedde på <b>Norsk jord</b>, <b>i Oslo</b>,
              <b>i bygget</b> hvor Hydro deler etasjer med If Skadeforsikring
              hvor <b>jeg</b>, og kanskje flere av dere også, <b>sitter</b> til
              daglig.<br /><br />
              * Hvor hang oppslagene?<br />
              * Hva følte vi da vi så de?<br /><br />

              * Kanskje dette er den <b>virkelige store vekkeren</b> vi trenger
              for å virkelig øke bevisstheten vår rundt IT-sikkeret, å
              <b>sikre Norge og norske interesser</b> bedre.<br /><br />

              Før vi starter på gåten må vi snakke om en elefant i rommet...
            </aside>
          </section>

          <section>
            <h3>Haien i rommet</h3>
            <aside class="notes">
              Nærmere bestemt en hai...
            </aside>
          </section>

          <section data-source="dagbladet_pst">
            <img
              src="img/intro/intro-dagbladet-pst2.png"
              class="plain"
              style="width: 60%"
            />
            <aside class="notes">
              Ooops. En dag i oktober 2018 lekte sønnen til kommunikasjonssjefen
              i PST med fars IPad. IPaden ble brukt til bl.a. å legge ut
              meldinger på PSTs twitter-konto: <b>@PST_Norge</b><br /><br />

              Sønnen spilte <b>Hungry Shark Evolution</b> og delte et bilde fra
              spillet til Twitter-appen, som da ble lagt ut på PSTs
              Twitter-konto.<br /><br />

              Det ble raskt oppdaget og slettet, men ble snappet opp av følgere
              og mediene. Folk trodde jo at PST hadde blitt <b>hacket</b
              ><br /><br />

              Det viser seg heldigvis at PST har et snev av selvironi, fordi
              gåten og løsningen som vi skal gå igjennom idag bærer preg av
              relativt mye hai, som dere snart skal få se.
            </aside>
          </section>

          <section>
            <h3>Stor takk til Roy Solberg</h3>
            <p>PST fjernet gåten i våres.</p>
            <p>
              Uten hjelp fra Roy og hans samling av filer ville det ikke blitt
              noe foredrag
            </p>
            <p class="fragment fade-up">
              😍👏 <a href="https://twitter.com/roysolberg">@roysolberg</a>
            </p>
            <aside class="notes">
              Før vi starter må jeg få lov å rette en stor takk til Roy!<br /><br />

              * Hva hjalp Roy med? (PST fjernet gåten, live-demo planene mine
              gikk ad undas<br />
              * Nå har jeg lært å ta vare på både løsningene OG oppgavene jeg
              løser (NESTE)<br /><br />

              Stor takk til Roy!
            </aside>
          </section>
        </section>

        <!-- =================== STILLINGSANNONSEN =================== -->
        <section>
          <section>
            <h2>Stillingsannonsen</h2>
            <aside class="notes">
              La oss starte med stillingsutlysningen PST la ut i vinter
            </aside>
          </section>

          <section data-source="stillingsannonsen_nrk">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_nrk-artikkel2.png"
              class="plain"
              style="width: 75%"
            />
            <aside class="notes">
              NRK lagde en sak om stillingsutlysningen og det var denne som jeg
              kom over en morgen på vei til jobb<br /><br />

              * Ble umiddelbart nysgjerrig<br />
              * Gjerne prøve meg på litt kodeknekking<br /><br />

              Og det er med et dikt i stillingsutlysningen vår reise begynner
            </aside>
          </section>

          <section data-transition="fade-in" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>?</h3>
            <aside class="notes">
              Se nøye på teksten<br />
              Er det noen som ser et mønster?
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>E</h3>
            <aside class="notes">
              Dette er første bokstav.
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ER</h3>
            <aside class="notes">
              Andre bokstav. Hva med nå? Ser vi et mønster i bokstavene vi
              plukker ut?
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERT</h3>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTH</h3>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHA</h3>
            <aside class="notes">
              Bokstavene vi plukker ut er store bokstaver i diktet
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHAI</h3>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHAII</h3>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHAIIT</h3>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHAIITW</h3>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHAIITWT</h3>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHAIITWTE</h3>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHAIITWTEU</h3>
            <aside class="notes">
              Noe vi har glemt? Er et punktum her. Hva får vi da?
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <h3>ERTHAIITWT.EU</h3>
            <aside class="notes">
              Sånn. Det ligner jo på en URL!
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <a href="http://ERTHAIITWT.EU">http://ERTHAIITWT.EU ➡</a>
            <aside class="notes">
              Oppgave løst, vi skal åpenbart til denne nettsiden
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_hangman.png"
              class="plain"
            />
            <h3 class="fragment fade-up">Blindspor!</h3>
            <aside class="notes">
              Uff da (NESTE)<br />
              Det var et blindspor! <br />
              <b>Incorrect order</b>
            </aside>
          </section>

          <section
            data-transition="default fade-in"
            data-source="roy_solberg_fra_pst"
          >
            <img
              data-src="img/stillingsannonsen/stillingsannonsen_diktet.png"
              class="plain"
            />
            <a href="http://ERTHAIITWT.EU">http://ERTHAIITWT.EU ➡</a>
            <aside class="notes">
              Hmm, rekkefølge er visst viktig. Vi får stokke om bokstavene litt
            </aside>
          </section>

          <section
            data-state="stillingsannonsen-scrambler-start"
            data-transition="fade-in default"
          >
            <h3>ERTHAIITWT.EU</h3>
            <h3>=</h3>
            <h3 id="scramble-id">ERTHAIITWT.EU</h3>
            <p class="fragment fade-up">👍</p>
            <aside class="notes">
              Der ja (NESTE) <br />
              Fett!
            </aside>
          </section>
        </section>

        <!-- =================== TWITTERHAI.EU =================== -->
        <section>
          <section><h2>TWITTERHAI.EU</h2></section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu.png"
              class="plain"
              style="width: 50%;"
            />
            <aside class="notes">
              Vi får opp en nettside med et haibilde og nok et dikt
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu_1337_shrk.jpg"
              class="plain"
            />
            <aside class="notes">
              Jeg liker å kikke på bildene først. Lurer på om det er noe gjemt i
              bildet.
            </aside>
          </section>

          <section>
            <p>Steganografi-analyse: <b>Stegsolve</b></p>
            <p>
              <b>Linux</b>:
              <a
                href="https://github.com/zardus/ctf-tools/blob/master/stegsolve/install"
                >kjør install-script</a
              >
            </p>
            <p>
              <b>Windows</b>:
              <a
                href="https://github.com/eugenekolo/sec-tools/raw/master/stego/stegsolve/stegsolve/stegsolve.jar"
                >last ned stegsolve.jar</a
              >
            </p>
            <aside class="notes">
              Å skjule noe i et bilde kalles <b>Steganografi</b><br />
              * Stegsolve: kikke igjennom fargefiltre, lete etter tekst og
              bilder
            </aside>
          </section>

          <section data-source="stegsolve_caesum">
            <pre><code data-trim class="shell">
              root@c04ddcc8bccd:~# java -jar stegsolve.jar</code></pre>
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-stegsolve.gif"
              class="plain"
              style="width: 75%;"
            />
            <aside class="notes">
              * Slik starter vi opp Stegsolve<br />
              * Har lastet inn haibildet<br />
              (VENTE 10s)<br />
              Her var det lite spennende
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <a class="fragment fade-up" href="http://twitterhai.eu/robots.txt"
              >http://twitterhai.eu/robots.txt ➡</a
            >
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-robots-txt.png"
              class="plain fragment"
            />
            <aside class="notes">
              * Vi fant ikke noe i bildet. Hvor kan vi finne ledetråder?<br />
              (NESTE) (Om robots.txt)<br />
              (NESTE) <br />
              * Var faktisk en robots.txt! <br />
              * "This is not the droid you are looking for. Use the
              <b>source</b>, Luke!"
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu.png"
              class="plain"
              style="width: 50%;"
            />
            <aside class="notes">
              * Use the source: vi får kikke i kildekoden på nettsiden<br />
              * Ofte lurt å kikke på kildekoden på nettsidene man skal hacke
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-source.png"
              class="plain"
              style="width: 75%"
            />
            <aside class="notes">
              * Her ser vi HTML-koden bak nettsiden<br />
              * La oss ta zoome inn litt
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-shark-html-source-zoomed.png"
              class="plain"
            />
            <p>?</p>
            <aside class="notes">
              * Noen som legger merke til noe interessant her?<br />
              * Er plasseringen av teksten tilfeldig?<br />
              * Se mot på venstre marg<br />
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-shark-html-source-zoomed-highlighted.png"
              class="plain"
            />
            <p>shark.html</p>
            <aside class="notes">
              shark.html gjemt vertikalt, snedig!
            </aside>
          </section>

          <section>
            <a href="http://twitterhai.eu/shark.html"
              >http://twitterhai.eu/shark.html ➡</a
            >
            <aside class="notes">
              Vi skal visst til en ny side: twitterhai.eu/shark.html
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-case_matters.png"
              class="plain"
            />
            <aside class="notes">
              "Case matters. Watch your characters"<br />
              * Hva mener de?
            </aside>
          </section>

          <section
            data-transition="none"
            data-source="joshua_reynolds"
            data-background="img/twitterhai-eu/twitterhai-eu-Samuel_Johnson_by_Joshua_Reynolds_small.png"
          >
            <aside class="notes">Vi må ta en nærmere kikk.</aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-shark-html-source-zoomed-highlighted.png"
              class="plain"
            />
            <span>
              <a href="http://twitterhai.eu/Shark.html">http://twitterhai.eu/</a
              ><a href="http://twitterhai.eu/Shark.html" class="fragment"
                >Shark.html ➡</a
              >
            </span>
            <aside class="notes">
              * Noen som ser feilen jeg gjorde? (VENT 5s) (NESTE)<br />
              * Jeg misset at det var en stor S i shark.html<br />
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-shark-html.png"
              class="plain"
            />
            <h3 class="fragment fade-up">🤔</h3>
            <aside class="notes">
              Da kom vi videre!<br />

              * Får opp en nettside med råd om hvordan man lager en god
              jobbsøknad <br />
              (NESTE)<br />
              * Ikke så mye mer interessant her... vi får kikke på
              HTML-kildekoden
            </aside>
          </section>

          <section
            data-transition="fade-in default"
            data-source="roy_solberg_fra_pst"
          >
            <img
              data-src="img/twitterhai-eu/twitterhai-eu-shark-html-source.png"
              class="plain"
            />
            <h3 class="fragment fade-up">🤔🤔🤔</h3>
            <aside class="notes">
              Vi gransker HTML-kildekoden og finner et par interessante
              kommentarer i koden:<br /><br />
              * Vi får tips om at NAVs nettsider inneholder tips på hvordan
              skrive en god jobbsøknad.<br />
              * "Vi har flere oppgaver. Se nøye etter, så finner du de."<br /><br />
              (NESTE)<br />

              Så vi må et par steg tilbake og ta en grundigere kikk
            </aside>
          </section>
        </section>

        <!-- =================== 1337_shrk.jpg =================== -->
        <section>
          <section>
            <h2>1337_shrk.jpg</h2>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu.png"
              class="plain"
              style="width: 50%"
            />
            <aside class="notes">
              Vi er tilbake på twitterhai.eu. Hva bør vi kikke nærmere på?
            </aside>
          </section>

          <section data-transition="fade-in" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitterhai-eu/twitterhai-eu_1337_shrk.jpg"
              class="plain"
            />
            <aside class="notes">
              Vi har flere bildeanalyseverktøy...
            </aside>
          </section>

          <section>
            <p>
              <b>Linux</b>: binæranalyse med
              <span class="fragment highlight-green">binwalk</span>
            </p>
            <pre
              class="fragment fade-up"
            ><code class="shell smaller" data-trim data-noescape>
                root@c04ddcc8bccd:~# binwalk 1337_shrk.jpg

                DECIMAL       HEXADECIMAL     DESCRIPTION
                --------------------------------------------------------------------------------
                0             0x0             <mark>JPEG image data</mark>, JFIF standard 1.01
                30            0x1E            <mark>TIFF image data</mark>, big-endian, offset of first image directory: 8
              </code></pre>
            <aside class="notes">
              * Når vi skal analysere filer liker jeg å bruke
              <b>binwalk</b> (NESTE)<br />
              * Hva gjør binwalk?<br />
              (NESTE) <br />
              * Og vi får bekreftet at vi har et bilde, TIFF komprimert til
              JPEG. Ikke noe spennende her.
            </aside>
          </section>

          <section>
            <p>
              <b>Linux</b>: binæranalyse med
              <span class="fragment highlight-green">strings</span>
            </p>
            <pre
              class="fragment fade-up"
            ><code class="shell smaller" data-trim data-noescape>
              root@c04ddcc8bccd:~# strings -10 1337_shrk.jpg

              [...] (klippet vekk XML og tom data)
              [...] (klippet vekk tom data)

              8Photoshop 3.0
              <mark class="fragment">/haitech_secure.html</mark>
              %&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz
              &'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz
              NE/i}N|xSP
              E-A#uYM6'=E`
              kNP5k+a1XZ
              Ql`T>^GLUd
            </code></pre>
            <aside class="notes">
              * Jeg liker også å bruke programmet <b>strings</b> på filer
              (NESTE)<br />
              * Hva gjør strings?<br />
              (NESTE) <br />
              * Vi ser mye tulletekst bl.a. (NESTE) <br />
              * Og noe VELDIG interessant! Kommer straks tilbake til den
            </aside>
          </section>

          <section>
            <p>
              <b>Linux</b>: binæranalyse med
              <span class="fragment highlight-green">file</span>
            </p>
            <pre
              class="fragment fade-up"
            ><code class="shell smaller" data-trim data-noescape>
              root@c04ddcc8bccd:~# file 1337_shrk.jpg

              1337_shrk.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, /
              density 72x72, segment length 16, Exif Standard: [TIFF image data, /
              big-endian, direntries=3, PhotometricIntepretation=RGB, /
              orientation=upper-left], <mark class="fragment">comment: "/haitech_secure.html"</mark>, /
              baseline, precision 8, 851x514, components 3
            </code></pre>
            <aside class="notes">
              * Jeg liker også å bruke programmet <b>file</b> (NESTE) på filer
              for å se alle filegenskapene. <br />

              * Både <b>file</b> og <b>strings</b> er fine go-to verktøy når du
              skal scanne raskt igjennom en fil på utkikk etter ledetråder
              (NESTE)<br />
              (NESTE)<br />
              * Vi ser at det skjuler seg en tekst i bildefilens kommentarfelt!
              (haitech_secure.html)<br />
              * Bildekommentarer er et typisk sted å lete etter ledetråder på
              CTF'er<br /><br />

              (ANEKDOTE) <br />
              * Hvorfor er tekst i bildekommentarer/data-chunks i PNG-bilder
              farlig?
            </aside>
          </section>

          <section>
            <p>
              <b>Windows</b>: binæranalyse med
              <span class="fragment highlight-green">filegenskaper</span>
            </p>
            <aside class="notes">
              * Hvis du bruker Windows er alltids høyreklikk på filen og
              "Egenskaper" (NESTE) en god start. <br />
              * Ellers bare åpne i et tekstprogram for å kikke etter ledetråder
            </aside>
          </section>

          <section data-source="exif_regex_info">
            <img
              data-src="img/1337_shrk-jpg/1337_shrk-jeffreysmetadataviewer-highlighted.png"
              class="plain"
              style="width: 75%"
            />
            <aside class="notes">
              * I CTF'er gjelder det av og til å være effektiv så da bruker man
              Google for å finne et verktøy, enn å gjøre altfor mye jobb selv<br />
              * Her har vi en nettside som henter ut metadata fra et bilde, og
              her ser vi bildekommentaren som vi fant tidligere med
              <b>file</b> og <b>strings</b>
            </aside>
          </section>

          <section data-transition="fade-in default">
            <a href="http://twitterhai.eu/haitech_secure.html"
              >http://twitterhai.eu/haitech_secure.html ➡</a
            >
            <p class="fragment fade-up">👍</p>
            <aside class="notes">
              Kult! (NESTE)<br />
              Vi har en ny nettside å gå videre til
            </aside>
          </section>
        </section>

        <!-- =================== INNLOGGING =================== -->
        <section>
          <section><h2>Sårbar innlogging</h2></section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/innlogging/innlogging_haitech_secure-html.png"
              class="plain"
            />
            <aside class="notes">
              * Vi kommer til nok en side med tips om å skrive en god
              jobbsøknad. Forteller at du vil bli testet på intervjuet.<br />
              * Vi legger merke til at vi skal logge inn med et passord<br />
              * Vi har ikke så mange ledetråder her så vi får kikke på
              HTML-kildekoden igjen
            </aside>
          </section>

          <section data-transition="fade-in" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/innlogging/innlogging_haitech_secure-html-source.png"
              class="plain"
              width="75%"
            />
            <aside class="notes">
              Her er det visst en del som skjer
            </aside>
          </section>

          <section data-transition="none" data-source="roy_solberg_fra_pst">
            <img
              data-src="img/innlogging/innlogging_haitech_secure-html-source-highlighted.png"
              class="plain"
              width="75%"
            />
            <aside class="notes">
              Det vi ser er JavaScript-kode som gjør passordvalidering. At det
              er i JavaSciprt er flaks for oss, da kan vi se lese og prøve å
              forstå hva som skjer der passordet blir forsøkt validert<br />

              1. Det første som skjer etter at vi har tastet inn passordet og
              trykker ENTER, er å trigge funksjonen "login()"<br />
              2. I login()-funksjonen er det en chiffertekst på pkt. 2, hva
              brukes den til? (hva er chiffertekst)<br />
              3. På pkt. 3 ser vi et if-uttrykk. Den gjør true/false-sjekker på
              passordet vi oppgir.<br />
              Hvis hele uttrykket blir sant:<br />
              * så blir funksjonen <b>decrypt()</b> brukt med chifferteksten og
              passordet vårt som parametere. Tilbake får man dekryptert
              chiffertekst. <br />
              * deretter spretter det opp en pop-up med denne dekrypterte
              chifferteksten. Spennende!<br /><br />

              Vi er nødt til å finne ut hva passordet er!
            </aside>
          </section>

          <section>
            <p>Det vil si... på tide å hacke 😎</p>
            <p class="fragment fade-up">
              For å komme videre må vi ha
              <span class="fragment highlight-green">riktig passord</span>
            </p>
            <aside class="notes">
              Det er på tide å hacke!<br />
              (NESTE)<br />

              Dette handler om å reverseengineere logikken i
              JavaScript-kodesnutten som validerer passordet, slik at vi finner
              passordet (NESTE) ut ifra hva den godtar<br /><br />

              Denne typen "kodeknekking"/hacking finner man ofte på enklere
              CTF-oppgaver (forstå logikken og kalkulere seg til et passord)<br /><br />

              La oss ta en nærmere kikk på denne passordvalideringen
            </aside>
          </section>

          <section data-transition="none fade-in">
            <p>Passordvalidering i login():</p>
            <pre>
              <code data-trim class="javascript smaller" data-line-numbers="">
              password.charCodeAt(0) == 8 * 8 + 8 &&
              password.charCodeAt(1) == Math.pow(9, 2) - 29 &&
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) &&
              password.charCodeAt(3) == password.charCodeAt(2) &&
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <a
              href="https://www.rapidtables.com/convert/number/ascii-hex-bin-dec-converter.html"
              class="fragment"
              >ASCII-til-hex/bin/dec-converter</a
            >
            <aside class="notes">
              Her har vi logikken vi må knekke:<br />
              * For hver tegn i passordet må vi finne et tall.<br />
              * Tallet må vi gjøre om til et tegn. Det gjør vi ved å slå opp
              tallet i noe som kalles ASCII-tabellen, en liste over alle tegn på
              tastaturet ditt, hvor hver tegn har en tallverdi.<br />
              * Hver tegn vi finner på hver linje her blir tilsammen passordet
              vi er på jakt etter<br /><br />

              (NESTE)<br />
              Veldig kjekt å bruke et verktøy for å gå til/fra tall og
              ASCII-tegn. Dette er en side jeg ofte bruker
            </aside>
          </section>

          <section
            data-transition="none"
            data-code-frame="osx"
            data-highlight-theme="solarized-dark"
          >
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="1" >
              password.charCodeAt(0) == 8 * 8 + 8 &&
              password.charCodeAt(1) == Math.pow(9, 2) - 29 &&
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) &&
              password.charCodeAt(3) == password.charCodeAt(2) &&
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>?</p>
            <aside class="notes">
              Så vi begynner med første tegn i passordet.<br />
              Hva blir 8 * 8 + 8?
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="1">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 &&
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) &&
              password.charCodeAt(3) == password.charCodeAt(2) &&
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H</p>
            <aside class="notes"><b>72, H</b><br /></aside>
          </section>

          <section data-transition="none">
            <pre>
                  <code class="javascript smaller" data-trim data-line-numbers="2">
                  password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
                  password.charCodeAt(1) == Math.pow(9, 2) - 29 &&
                  password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) &&
                  password.charCodeAt(3) == password.charCodeAt(2) &&
                  password.substring(4, 5) == 3 &&
                  password.charCodeAt(5) == 7 * 17 - 5 &&
                  password.charCodeAt(6) == password.charCodeAt(0) &&
                  password.charCodeAt(7) == password.charCodeAt(1) &&
                  password.charCodeAt(8) == 0x69
                  </code>
                </pre>
            <p>H</p>
            <aside class="notes">
              Math.pow, dvs. x opphøyd i y.<br />
              9^2 - 29?
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="2">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) &&
              password.charCodeAt(3) == password.charCodeAt(2) &&
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4</p>
            <aside class="notes"><b>52, 4</b><br /></aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="3">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) &&
              password.charCodeAt(3) == password.charCodeAt(2) &&
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4</p>
            <aside class="notes">
              x opphøyd i y igjen.<br />
              10^2 + 3^2?
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="3">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) &&
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4m</p>
            <aside class="notes">
              <b>109, m</b>
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="4">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) &&
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4m</p>
            <aside class="notes">
              Tallverdien på det 4. tegnet i passordet må være lik det 3.
              tegnet:<br />
              Artig. Uttrykket blir sant når verdien er lik svaret på forrige
              linje
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="4">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm</p>
            <aside class="notes">
              <b>109, m</b>
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="5">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 &&
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm</p>
            <aside class="notes">
              Neste tegn ser vi i uttrykket må være 3-tall, fordi det er en
              konstant.<br />
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="5">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm3</p>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="6">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 &&
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm3</p>
            <aside class="notes">
              7 * 17 - 5
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="6">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 && // 114 = r
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm3r</p>
            <aside class="notes">
              <b>114, r</b>
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="7">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 && // 114 = r
              password.charCodeAt(6) == password.charCodeAt(0) &&
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm3r</p>
            <aside class="notes">
              password.charCodeAt(0):<br />
              Vi skal ha ASCII-tallet til passordets <b>første tegn</b>. Hva har
              vi funnet ut er passordets første tegn?
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="7">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 && // 114 = r
              password.charCodeAt(6) == password.charCodeAt(0) && // 72 = H
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm3rH</p>
            <aside class="notes"><b>72, H</b></aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="8">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 && // 114 = r
              password.charCodeAt(6) == password.charCodeAt(0) && // 72 = H
              password.charCodeAt(7) == password.charCodeAt(1) &&
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm3rH</p>
            <aside class="notes">
              password.charCodeAt(1):<br />
              Vi skal ha ASCII-tallet til passordets <b>andre tegn</b>. Hva har
              vi funnet ut er passordets andre tegn?
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="8">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 && // 114 = r
              password.charCodeAt(6) == password.charCodeAt(0) && // 72 = H
              password.charCodeAt(7) == password.charCodeAt(1) && // 52 = 4
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm3rH4</p>
            <aside class="notes">
              <b>52, 4</b><br />
              De av dere som er observante ser kanskje hva passordet ser ut til
              å bli...
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="9">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 && // 114 = r
              password.charCodeAt(6) == password.charCodeAt(0) && // 72 = H
              password.charCodeAt(7) == password.charCodeAt(1) && // 52 = 4
              password.charCodeAt(8) == 0x69
              </code>
            </pre>
            <p>H4mm3rH4</p>
            <aside class="notes">
              Vi må finne ut hva tallet til hexadesimalet <b>0x69</b> er.
            </aside>
          </section>

          <section data-transition="none">
            <pre>
              <code class="javascript smaller" data-trim data-line-numbers="9">
              password.charCodeAt(0) == 8 * 8 + 8 && // 72 = H
              password.charCodeAt(1) == Math.pow(9, 2) - 29 && // 52 = 4
              password.charCodeAt(2) == Math.pow(10, 2) + Math.pow(3, 2) && // 109 = m
              password.charCodeAt(3) == password.charCodeAt(2) && // 109 = m
              password.substring(4, 5) == 3 && // 3
              password.charCodeAt(5) == 7 * 17 - 5 && // 114 = r
              password.charCodeAt(6) == password.charCodeAt(0) && // 72 = H
              password.charCodeAt(7) == password.charCodeAt(1) && // 52 = 4
              password.charCodeAt(8) == 0x69 // 105 = i
              </code>
            </pre>
            <p>H4mm3rH4i 🦈</p>
            <aside class="notes">
              <b>105, i</b><br />
              Vi har klart å tolke valideringen og kalkulert oss fram til et
              passord som vil glatt passere valideringen!<br /><br />

              * På siden med passordfeltet taster jeg inn <b>H4mm3H4i</b><br />
              * if ()-uttrykket for passordvalidering blir <b>true</b><br />
              * decrypt(ciphertext, passord) dekrypterer ciphertext-strengen<br />
              * En melding vises ved passordfeltet: <b>Kult! Du er en råing!</b
              ><br />
              * Til slutt: alert-boks vises med dekryptert chiffertekst
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/innlogging/innlogging_haitech_secure-html-alert.png"
              class="plain"
            />
            <p class="fragment">
              uggc:// = http:// med 13 rotasjoner
            </p>
            <p class="fragment">
              <a href="https://www.boxentriq.com/code-breaking/caesar-cipher"
                >Ceasar chiffer?</a
              >
            </p>
            <p class="fragment">
              altså
              <a
                href="https://en.wikipedia.org/wiki/ROT13"
                alt="ROT-13 Ceaser cipher"
                title="ROT-13 Ceaser cipher"
                >ROT-13 Ceasar chiffer</a
              >
            </p>
            <aside class="notes">
              Ser vi noe mønster i den rare teksten? Hva ligner det på?
              (NESTE)<br />
              * Hint: :// - ligner på en url med rare tegn? Forskjøvet? <br />
              * Hint: Ceasar er nevnt<br />
              * Kan det være Ceasar chiffer? (NESTE) (hva er det?)<br />
              (NESTE) <br />
              * Dette er en tekst som er kryptert med en teknikk som kalles
              <b>ROT-13 Ceasar chiffer</b>
            </aside>
          </section>

          <section data-source="ceasar_wheel">
            <img
              data-src="img/innlogging/innlogging_haitech_secure-html-ceasar-wheel.jpg"
              class="plain"
              style="width: 60%"
            />
            <aside class="notes">
              * Disse skivene demonstrerer hvordan man krypterer en tekst uten å
              bruke en krypteringsnøkkel. <br />
              * Istedet roteres skiven for hver bokstav i en tekst 13 ganger.
              Den som skal lese den krypterte teksten, roterer tilbake 13
              ganger, og kan dermed lese teksten.<br />
              * Populært i romertiden, effektiv, billig og enkel kryptering
            </aside>
          </section>

          <section data-source="ceasar_cipher_decryption_tool">
            <img
              data-src="img/innlogging/innlogging_haitech_secure-html-ceasar-decrypted-highlighted.png"
              class="plain"
              style="width: 60%"
            />
            <p class="fragment">
              <a href="http://twitterhai.tech/hai_there.html"
                >http://twitterhai.tech/hai_there.html ➡
              </a>
            </p>
            <aside class="notes">
              * Som nevnt tidligere, vil man være rask finnes det nesten alltid
              en løsning hvis man Googler litt.<br />
              * Kan også lage kodesnutt som gjør dette<br />
              (NESTE)<br />
              * Vi har en ny nettside å gå videre til!
            </aside>
          </section>

          <section
            data-transition="fade-in default"
            data-source="roy_solberg_fra_pst"
          >
            <img
              data-src="img/innlogging/innlogging_haitech-secure-hai_there.png"
              class="plain"
            />
            <p class="fragment fade-up">👌</p>
            <aside class="notes">
              Ser ut som vi skal på Twitter! (NESTE)<br /><br />

              Det var faktisk en måte å komme hit på etter at man knakk koden i
              diktet...
            </aside>
          </section>

          <section data-source="twitterhai_eu_domaintools">
            <img
              data-src="img/innlogging/innlogging_dns-reverse-lookup.png"
              class="plain"
            />
            <aside class="notes">
              * Hvis man gjør en "Reverse IP lookup", altså finne hvilke andre
              domener eier av IP-adressen <b>twitterhai.eu</b> er assosiert med,
              så finner vi <b>twitterhai.tech</b><br /><br />

              * Hvis man gikk til <b>twitterhai.tech</b> fikk man samme melding
              om å sjekke ut Twitter-kontoen som vi så nettopp. Artig!<br /><br />

              Så det bringer oss til Twitter!
            </aside>
          </section>
        </section>

        <!-- =================== TWITT3Rhai =================== -->
        <section>
          <section>
            <h2>TWITT3RHAI</h2>
          </section>

          <section data-source="roy_solberg">
            <img
              data-src="img/twitt3rhai/twitt3rhai-twitterkonto-aug-2019.png"
              class="plain"
            />
            <aside class="notes">
              Vi kommer da til profilen til <b>twitt3rhai</b><br /><br />

              Et par observasjoner:<br />
              * Roboter og å flytte tekst til tekstprogram nevnes<br />
              * 65 tweets med haiarter!<br />
            </aside>
          </section>

          <section data-source="twitter">
            <img
              data-src="img/twitt3rhai/twitt3rhai-twitterkonto-innlegg-zoomed.png"
              class="plain"
            />
            <aside class="notes">
              * ROBOTS - kan de mene denne robots.txt-filen? (som alltid er
              kjekk å se etter)<br />
              * Hvilken tekst skal jeg flytte til et tekstprogram?
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <p>La oss først se etter <b>robots.txt</b></p>
            <a href="http://twitterhai.tech/robots.txt" class="fragment"
              >http://twitterhai.tech/robots.txt ➡</a
            >
            <img
              data-src="img/twitt3rhai/twitt3rhai-twitterkonto-robots_txt-highlighted.png"
              class="plain fragment"
            />
            <aside class="notes">
              * La oss først finne robots.txt<br />
              (NESTE)<br />
              * Vi går til twitterhai.tech/robots.txt<br />
              (NESTE)<br />
              * Se der! <b>Disallow: /min_hemmelige_mappe</b> (hva betyr
              det?)<br />
              * Hvis vi går til twitterhai.tech/min_hemmelige_mappe, hva finner
              vi der?
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/twitt3rhai/twitt3rhai-twitterkonto-haimat-highlighted.png"
              class="plain"
            />
            <p class="fragment">👍</p>
            <aside class="notes">
              Vi fant en fil! <b>haimat</b><br />
              (NESTE)<br /><br />

              Så var det de twitterhaiene
            </aside>
          </section>

          <section data-source="twitter">
            <img
              data-src="img/twitt3rhai/twitt3rhai-twitterkonto-innlegg-zoomed.png"
              class="plain"
            />
            <aside class="notes">
              (ZOOM INN)<br />
              Ser ikke noe mønster i haitweetene. For mye hai. <br />
              Får ta ut tekstene til et tekstprogram.
            </aside>
          </section>

          <section>
            <p>*klipper ut og limer inn en og en tweet til Sublime*</p>
            <aside class="notes">
              * Sublime er et tekstprogram jeg liker men kunne likegjerne vært
              Notepad, VIM etc.<br />

              * Vurderte å lage en liten kodesnutt i JavaScript for å kopiere.
              <br />

              * Gadd ikke å bruke tid på det da det ikke tok lang tid å "brute
              force" klippe og lime. Av og til i CTF'er er det en helt grei måte
              å komme kjapt videre på.
            </aside>
          </section>

          <section
            data-state="twitt3rhai-textwriter-start"
            data-source="roy_solberg_blogg"
          >
            <pre>
              <code id="twitt3rhai-textwriter-target" class="javascript" data-trim>
              </code>
            </pre>
            <h3 id="twitt3rhai-textwriter-target-password"></h3>
            <aside class="notes">
              Så se for dere at jeg klipper og limer her.<br />
              Veldig kult med negativ tekst! Gøy å se løsningen åpenbare seg på
              denne måten!
            </aside>
          </section>

          <section data-transition="fade-in default">
            <p>2 funn å ta med oss videre:</p>
            <ul>
              <li class="fragment">
                <a href="http://twitterhai.tech/min_hemmelige_mappe/haimat">
                  http://twitterhai.tech/min_hemmelige_mappe/haimat</a
                >
              </li>
              <li class="fragment">
                <p><b>HAI1337</b></p>
              </li>
            </ul>
            <p class="fragment fade-up">😃</p>
            <aside class="notes">
              * Så vi har 2 funn å ta med oss til neste steg <br />
              (NESTE)<br />
              * denne mystiske hemmelige filen<br />
              (NESTE) <br />
              * og HAI1337<br />
              (NESTE)
            </aside>
          </section>
        </section>

        <!-- =================== HAIMAT =================== -->
        <section>
          <section>
            <h2>haimat</h2>
          </section>

          <section data-transition="fade-in">
            <p>
              <b>Linux</b>: binæranalyse med
              <span class="fragment highlight-green">file</span>
            </p>
            <pre class="fragment fade-up">
              <code class="shell smaller" data-trim data-noescape>
                root@c04ddcc8bccd:~# file haimat

                pcap-ng capture file - version 1.0
              </code>
            </pre>
            <aside class="notes">
              Vi tar en kikk med (NESTE) <b>file</b> i Linux for å se på
              filen<br />
              (NESTE)<br />
              * Legger umiddelbart merke til <b>pcap</b>! <br />
              * Dette er en fil som inneholder nettverkstrafikk
            </aside>
          </section>

          <section>
            <p>
              <b>Windows</b>: binæranalyse med
              <span class="fragment highlight-green"
                >filegenskaper/Notepad</span
              >
            </p>
            <pre class="fragment fade-up">
              <code class="shell smaller" data-trim data-noescape>
                  C:\haimat>notepad haimat

                  [...] Dumpcap (Wireshark) 2.4.6 [...]
              </code>
            </pre>
            <aside class="notes">
              * Tilsvarende på Windows er å bare åpne filen med (NESTE)
              <b>filegenskaper/Notepad</b><br />
              (NESTE)<br />
              * Da ser vi t.o.m. at Wireshark er nevnt, er helt sikker på at
              dette er nettverkstrafikk
            </aside>
          </section>

          <section>
            <p>
              <b>haimat</b> er en
              <a href="https://en.wikipedia.org/wiki/Pcap">pcap</a> fil!
            </p>
            <p class="fragment">Brukes til å lagre nettverkstrafikk</p>
            <p class="fragment">Vi har ca 400 TCP-pakker å analysere</p>
            <aside class="notes">
              * Så da vet vi at <b>haimat</b> er en <b>pcap</b> fil!<br />
              (NESTE)<br />
              * Filen lages når man tar opp trafikken som avlyttes mellom to
              maskiner<br />
              (NESTE)<br />
              * I filen ser vi at det er 400 TCP-pakker vi må analysere
            </aside>
          </section>

          <section>
            <h3>Linux</h3>
            <p class="fragment">
              Nettverksanalyse med
              <span class="fragment highlight-green">tcpdump/NetworkMiner</span>
            </p>
            <aside class="notes">
              (NESTE)<br />
              * Hvis man foretrekker Linux er (NESTE)<b>tcpdump/NetworkMiner</b>
              fine programmer for å jobbe med pcap-filer.<br />
              * NetworkMiner er god hvis det er mye trafikk å analysere.
            </aside>
          </section>

          <section>
            <h3>Windows</h3>
            <p class="fragment">
              Nettverksanalyse med
              <span class="fragment highlight-green"
                >Wireshark/tshark/NetworkMiner</span
              >
            </p>
            <aside class="notes">
              (NESTE)<br />
              * På Windows brukte jeg (NESTE) Wireshark. Gir god oversikt og
              grei å bla igjennom datapakkene med <br />
              * tshark/NetworkMiner er også alternativer på Windows
            </aside>
          </section>

          <section data-transition="fade-out" data-source="wireshark">
            <img data-src="img/haimat/haimat-wireshark.png" class="plain" />
            <aside class="notes">
              Vi åpner Wireshark og begynner å kikke litt rundt.
            </aside>
          </section>

          <section data-transition="fade-in" data-source="wireshark">
            <img
              data-src="img/haimat/haimat-wireshark-webserver-root.png"
              class="plain"
            />
            <aside class="notes">
              * Vi ser fort spor etter mye HTTP-pakker, så mest sannsynlig noen
              som har avlyttet trafikken mellom bruker og en webserver.
            </aside>
          </section>

          <section data-transition="none fade-out" data-source="wireshark">
            <img
              data-src="img/haimat/haimat-wireshark-webserver-root-highlighted.png"
              class="plain"
            />
            <aside class="notes">
              Det første vi ser er en HTTP-forespørsel mot rotmappen på server
              192.168.230.129. Vi ser deretter en HTTP-respons med text-html.
              Innholdet er en HTML-side med link til en "secret_data"
              zip-fil!<br /><br />
              Det vi gjør nå er godt spionhåndtverk, nemlig kikke og lytte på
              åpen web-trafikk. Dette er forresten hvorfor vi må bruke
              SSL/TLS-kryptering på nettsidene våre og krypterte
              meldingstjenester! Da unngår du snoking som vi driver med nå
            </aside>
          </section>

          <section>
            <p>Første observasjon...</p>
            <p class="fragment">
              I nettverkspakke 146 gjøres det en HTTP-forespørsel mot
              <a href="http://192.168.230.129">http://192.168.230.129</a>
            </p>
            <p class="fragment">
              I HTTP-svaret er det en HTML-side med link til
              <a href="/secret_data.zip">/secret_data.zip</a>
            </p>
            <aside class="notes">
              Vi har altså sett..<br />
              (NESTE)<br />
              * En forespørsel mot en side på en webserver<br />
              (NESTE)<br />
              * Et svar som viser en nettside med teksten "Her er dataene dine,
              passordet har du allerede" og en link til
              <b>secret_data.zip</b>
            </aside>
          </section>

          <section data-transition="none fade-in" data-source="wireshark">
            <img
              data-src="img/haimat/haimat-wireshark-request-secret_data_zip.png"
              class="plain"
            />
            <img
              data-src="img/haimat/haimat-wireshark-response-secret_data_zip.png"
              class="plain"
            />
            <aside class="notes">
              Hvis vi ser videre i datapakkene...<br />
            </aside>
          </section>

          <section data-transition="none" data-source="wireshark">
            <img
              data-src="img/haimat/haimat-wireshark-request-secret_data_zip-highlighted.png"
              class="plain"
            />
            <img
              data-src="img/haimat/haimat-wireshark-response-secret_data_zip-highlighted.png"
              class="plain"
            />
            <aside class="notes">
              * Så finner vi en HTTP-forespørsel for å laste ned denne
              zip-filen.<br />

              * Veldig nysgjerrig på hva som er i denne zip-filen!
            </aside>
          </section>

          <section>
            <p>Andre observasjon...</p>
            <p class="fragment">
              I nettverkspakke 326 og 362 er det henholdsvis en HTTP-forespørsel
              og -svar på å laste ned zip-filen:
              <a href="http://192.168.230.129/secret_data.zip"
                >http://192.168.230.129/secret_data.zip</a
              >
            </p>
            <p class="fragment">
              Trafikken er over TCP-port 80 og dermed ukryptert
              <span class="fragment fade-in">👍</span>
            </p>
            <p class="fragment">
              La oss plukke ut zip-filen for nærmere analyse
            </p>
            <aside class="notes">
              Så her ser vi...<br />
              (NESTE)<br />

              * En forespørsel fra en klient til webserveren om å hente ned
              <b>secret_data.zip</b> og selve svaret som inneholder zip-filen
              (NESTE)<br />

              * Og heldigvis for oss går trafikken over TCP-port 80 som gjør at
              vi ser all trafikk <br />
              (NESTE)<br />

              (NESTE)<br />
              * Vi får plukke ut denne filen og kikke nærmere på den!
            </aside>
          </section>

          <section>
            <h3>Forresten...</h3>
            <p>Siste observasjon fra nettverkstrafikken:</p>
            <p class="fragment">
              Et forsøk på å laste siden
              <a href="http://192.168.230.129/trying_to_hide"
                >http://192.168.230.129/trying_to_hide</a
              >
              gir
            </p>
            <p class="fragment">
              <span class="fragment highlight-green">404 Not Found 😜</span>
            </p>
            <aside class="notes">
              Og forresten, en siste observasjon av trafikken:<br />
              (NESTE) <br />
              * Bruker prøver å navigere til <b>/trying_to_hide</b> som ga
              (NESTE)<br />
              * 404 (NESTE) <br /><br />

              Kanskje spionen som plantet filen fikk panikk prøvde alle triks
              for å skjule sine spor?
            </aside>
          </section>

          <section>
            <p>Vi henter ut <b>secret_data.zip</b> med Wireshark</p>
            <aside class="notes">
              Tilbake til zip-filen. Vi bruker Wireshark til å eksportere ut
              binærdataene fra nettverkspakke 362 og lagrer dataene til disk som
              en zip-fil. <br />

              * Mange måter å gjøre dette på med Wireshark. Jeg viser en av
              flere måter man kan gjøre dette på.
            </aside>
          </section>

          <section data-transition="none fade-in" data-source="wireshark">
            <img
              data-src="img/haimat/haimat-wireshark-export-secret_data_zip.png"
              class="plain"
            />
            <aside class="notes">
              Vi finner pakken det gjelder som inneholder svaret fra webserveren
              med zip-filen
            </aside>
          </section>

          <section data-transition="none fade-out" data-source="wireshark">
            <img
              data-src="img/haimat/haimat-wireshark-export-secret_data_zip-highlighted.png"
              class="plain"
            />
            <aside class="notes">
              Vi velger pakken og høyreklikker på Media Type (selve
              binærdataene) og velger "Export Packet Bytes". <br /><br />

              Lagrer filen som <b>secret_data.zip</b>.
            </aside>
          </section>

          <section data-transition="none fade-in" data-source="windows10">
            <p>Vi har eksportert ut filen <b>secret_data.zip</b>:</p>
            <img
              data-src="img/secret_data-zip/secret_data-zip-file.png"
              class="plain"
            />
            <p class="fragment">😀</p>
            <aside class="notes">
              Nå har jeg lagret zip-filen og har åpnet den i WinZip (NESTE)
              <br />

              Vi kan se at i zip-filen ligger det et bilde
              <b>insignificant_shark.png</b>! Spennende!
            </aside>
          </section>
        </section>

        <!-- =================== SECRET_DATA.ZIP =================== -->
        <section>
          <section>
            <h2>secret_data.zip</h2>
          </section>

          <section data-transition="none fade-in" data-source="windows10">
            <p>Åpner bildet <b>insignificant_shark.png</b>:</p>
            <img
              data-src="img/secret_data-zip/secret_data-zip-file.png"
              class="plain"
            />
            <aside class="notes">
              Vi får åpne bildet da...
            </aside>
          </section>

          <section data-transition="none fade-out" data-source="windows10">
            <p>Passordbeskyttet! 😢</p>
            <img
              data-src="img/secret_data-zip/secret_data-zip-file-password.png"
              class="plain"
            />
            <aside class="notes">
              Det er en passordbeskyttet zip-fil!
            </aside>
          </section>

          <section>
            <p>🤔</p>
            <p class="fragment">
              Vi fikk beskjed om at vi allerede hadde passordet...
            </p>
            <p class="fragment">
              Hva hvis vi prøver <b>HAI1337</b> som passord?
            </p>
            <aside class="notes">
              Hm (NESTE)<br />
              * I forrige avsnitt fant vi en HTML-fil som sa at "passordet har
              du allerede". Fikk vi med oss noe fra tidligere som kan passe som
              passord? (NESTE)<br />
              * HAI1337 er en god kandidat
            </aside>
          </section>

          <section
            data-background="img/secret_data-zip/secret_data-zip-insignificant_shark.png"
            data-source="roy_solberg_fra_pst"
          >
            <aside class="notes">
              Oppsummert:<br />
              * Vi klarte å hente ut zip-filen fra nettverkstrafikken, og åpne
              bildet som lå i zip-filen med passordet fra Twitter.
              <br /><br />

              Det er noe fishy med denne haien...
            </aside>
          </section>
        </section>

        <!-- =================== INSIGNIFICANT_SHARK =================== -->
        <section>
          <section>
            <h2>Insignifikant hai</h2>
          </section>

          <section>
            <p>
              Vi zipper ut filen
              <span class="fragment highlight-green"
                >insignificant_shark.png</span
              >
            </p>
            <p class="fragment">
              Legger merke til kryptiske tegn på haien
            </p>
            <aside class="notes">
              * Vi henter ut (NESTE) <b>insignificant_shark.png</b> fra
              zip-filen og lagrer det til disk.<br />(NESTE)<br />

              * Legger først merke til kryptiske tegn, la oss se nærmere på de
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/secret_data-zip/secret_data-zip-insignificant_shark.png"
              class="plain"
            />
            <aside class="notes">
              La oss se nærmere på disse tegnene
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/insignificant_shark/insignificant_shark-lsb-runer.jpg"
              class="plain"
            />
            <p class="fragment">Ligner litt på runer?</p>
            <aside class="notes">
              (NESTE)<br />
              * Ligner veldig på runer <br />
              * Hva kan vi bruke for å tolke runene?
            </aside>
          </section>

          <section data-transition="none" data-source="snl_runer">
            <img
              data-src="img/insignificant_shark/insignificant_shark-snl-runer.png"
              class="plain"
              style="width: 60%"
            />
            <aside class="notes">
              * Her har vi en "Normalisert" utgave av det eldre runealfabetet<br />
              * Vi får prøve å finne en og en bokstav
            </aside>
          </section>

          <section data-transition="none" data-source="snl_runer">
            <img
              data-src="img/insignificant_shark/insignificant_shark-snl-runer-l.png"
              class="plain"
              style="width: 60%"
            />
            <h3>L</h3>
            <aside class="notes"><b>L</b></aside>
          </section>

          <section data-transition="none" data-source="snl_runer">
            <img
              data-src="img/insignificant_shark/insignificant_shark-snl-runer-s.png"
              class="plain"
              style="width: 60%"
            />
            <h3>LS</h3>
            <aside class="notes"><b>S</b></aside>
          </section>

          <section data-transition="none" data-source="snl_runer">
            <img
              data-src="img/insignificant_shark/insignificant_shark-snl-runer-b.png"
              class="plain"
              style="width: 60%"
            />
            <h3>LSB</h3>
            <aside class="notes"><b>B</b></aside>
          </section>

          <section>
            <p><b>LSB</b> betyr i IT-sammenheng ofte:</p>
            <p class="fragment">
              <a
                href="https://bit-calculator.com/most-and-least-significant-bit"
                >Least Significant Bit</a
              >
            </p>
            <p class="fragment smaller">
              (i motsetning til MSB: Most Significant Bit)
            </p>
            <aside class="notes">
              * LSB betyr i denne sammenhengen: (NESTE)<br />
              ** Least Significant Bit<br />
              (NESTE)<br />
              * I motsetning til det motsatte<br />
              ** Most Significant Bit
            </aside>
          </section>

          <section>
            <p>Alle filer består av binærdata (Bytes) med "0" og "1"-tall</p>
            <p class="fragment">
              Vi blir sterkt oppfordret til å se på siste Bit av hver Byte
              (LSB-dekoding)
            </p>
            <aside class="notes">
              * Alle filer på en datamaskin består av binære data, representert
              med 0 og 1-tall<br />
              * Samlet kaller vi disse tallene, 8 av gangen, for Bytes. Et tall
              er en Bit.<br />
              (NESTE) <br />
              * Å gjemme data i LSB er en velkjent måte på å "skjule" data i
              bilder. Det er gunstig måte å skjule data på fordi det påvirker
              orginalbildet i liten grad å bare endre en Bit i hver Byte.
            </aside>
          </section>

          <section>
            <p>Det vil si...</p>
            <p class="fragment">
              Plukk ut hvert siste binærtall i hver Byte: 1010101<span
                class="fragment highlight-green"
                >1</span
              >
            </p>
            <p class="fragment">og sett de sammen til ny fil</p>
            <aside class="notes">
              * Det vil si... (NESTE)<br />
              * Vi plukker ut det <b>siste</b> tallet i hver Byte (lengst til
              høyre)<br />
              (NESTE) (NESTE)<br />
              * Og setter de sammen til nye Bytes i en ny fil
            </aside>
          </section>

          <section data-source="incoherency_image_steganografi">
            <img
              data-src="img/insignificant_shark/insignificant_shark-lsb.png"
              class="plain"
              style="width: 60%"
            />
            <aside class="notes">
              * Fant et nyttig verktøy til å lese ut LSB fra en fil på nettet<br />
              * Etter LSB-dekoding ser vi en <b>QR-kode</b> gjemt i bildet<br />
            </aside>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/insignificant_shark/insignificant_shark-qrcode.png"
              class="plain"
            />
          </section>

          <section data-source="zxing_decode">
            <span>
              <img
                src="img/insignificant_shark/insignificant_shark-qrcode-decoded-highlighted.png"
                class="plain"
              />
              <p>
                "You thought we would hide anything of
                <span class="fragment highlight-green">SIGNIFICANCE</span>? Not
                the <span class="fragment highlight-green">LEAST</span>..."
              </p>
            </span>
            <aside class="notes">
              * Vi trenger å dekode QR-koden, bruker nettside som tolker
              QR-koder. Man kan også kode dette selv<br />
              * QR-koden var en tekst: (LES TEKSTEN) (NESTE) (NESTE)<br />
              * Så veldig fokus på signifikans og siste "ett-eller-annet" <br />
              * Vi får ikke mer her, vi har jo allerede prøvd oss på
              LSB-dekoding
            </aside>
          </section>

          <section>
            <p>
              Runene hintet om
              <span class="fragment highlight-green">LSB-dekoding</span>
            </p>
            <p>
              Skjult QR-kode hintet også om
              <span class="fragment highlight-green">LSB-dekoding</span>
            </p>
            <p>🤷‍♂️</p>
            <p class="fragment fade-in">
              Hva med
              <span class="fragment highlight-green">MSB-dekoding</span>? 😄
            </p>
            <aside class="notes">
              * Runene hintet om LSB-dekoding (NESTE)<br />
              * QR-koden hintet også om LSB-dekoding (NESTE)<br />
              * Hvor går man videre nå? LSB-dekoding var bare et sidespor til
              forvirring<br />
              * Har jeg prøvd alle dekodingsmuligheter?<br />
              (NESTE) <br /><br />

              * Hva med Most Significant Bit dekoding? (NESTE)
            </aside>
          </section>

          <section>
            <p>Det vil si...</p>
            <p class="fragment">
              Plukk ut hvert første binærtall i hver Byte:
              <span class="fragment highlight-green">1</span>1010101
            </p>
            <p class="fragment">og sett de sammen til en ny fil</p>
            <aside class="notes">
              * Det vil si... (NESTE)<br />
              * Vi plukker ut det <b>første</b> tallet i hver Byte (lengst til
              venstre)<br />
              (NESTE) (NESTE)<br />
              * Og setter de sammen til nye Bytes i en ny fil
            </aside>
          </section>

          <section data-source="georgeom_stegonline">
            <img
              data-src="img/insignificant_shark/insignificant_shark-msb-highlighted.png"
              class="plain"
              style="width: 60%"
            />
            <aside class="notes">
              * Fant også en nettside for MSB-dekoding<br />
              * Her har jeg allerede lastet opp bildet, og valgt å hente ut alle
              første Bits i hver Byte<br />
              * Jeg klikker på "Go"-knappen og...
            </aside>
          </section>

          <section
            data-transition="none fade-in"
            data-source="georgeom_stegonline"
          >
            <img
              data-src="img/insignificant_shark/insignificant_shark-msb-decoded-highlighted.png"
              class="plain"
            />
            <p>
              <a href="http://twitterhai.tech/u_are_th3_winrar.jpg"
                >http://twitterhai.tech/u_are_th3_winrar.jpg ➡</a
              >
            </p>
            <p class="fragment fade-up">👍</p>

            <aside class="notes">
              * Se der! Vi har en tekstsnutt!<br />
              * Vi skal videre til en ny fil (et bilde) (NESTE)<br /><br />

              Oppsummert: <br />
              * I haibildet var det runer, de sa vi skulle bry oss om LSB (<b
                >Least Significant Bit</b
              >)<br />
              * Vi brukte LSB-dekoding på filen og vi fant QR-kodebildet <br />
              * Vi dekodet QR-kodebildet som hintet igjen om LSB-dekoding. Vi
              lærte ikke noe mer, LSB-dekoding et sidespor<br /><br />

              * Da vi istedet brukte MSB-dekoding (<b>Most Significant Bit</b>)
              på filen, fant vi tekst som er en URL til et nytt bilde
            </aside>
          </section>
        </section>

        <!-- =================== U_ARE_TH3_WINRAR =================== -->
        <section>
          <section>
            <h2>u_are_th3_winrar.jpg</h2>
          </section>

          <section data-source="roy_solberg_fra_pst">
            <img
              data-src="img/u_are_th3_winrar-jpg/u_are_th3_winrar.png"
              class="plain"
            />
            <aside class="notes">
              Og her ser vi bildet: <b>Do we have a winner?</b><br />
              (PAUSE, 3s)
            </aside>
          </section>

          <section>
            <p>2 observasjoner...</p>
            <p class="fragment"><b>8,56 MB</b> stort JPG-bilde!</p>
            <p class="fragment">
              Filnavnet inneholder <b>WinRar</b> (kompresjonsformat)
            </p>
            <aside class="notes">
              Et par observasjoner: <br />
              (NESTE) <br />
              * Veldig stort bilde (over 8 MB) <br />
              (NESTE)<br />
              * Filnavnet hinter om programmet WinRar: et format for å
              komprimere filer<br />
              * Vi har en ny fil. Hva gjør vi når vi får en ny fil?
            </aside>
          </section>

          <section>
            <p>
              <b>Linux</b>: binæranalyse med
              <span class="fragment highlight-green">file</span>
            </p>
            <pre
              class="fragment fade-up"
            ><code class="shell smaller" data-trim data-noescape>
              root@c04ddcc8bccd:~# file u_are_th3_winrar.jpg

              u_are_th3_winrar.jpg: JPEG image data, JFIF standard 1.01, \
              resolution (DPI), density 96x96, segment length 16, \
              Exif Standard: [TIFF image data, big-endian, direntries=1, \
              orientation=upper-left], \
              comment: "CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 82", \
              baseline, precision 8, 664x636, components 3
            </code></pre>
            <aside class="notes">
              Vi kjører full analyse! Begynner med <b>file</b><br />
              (NESTE)<br />
              (NESTE)<br />
              Ikke noe som stikker seg ut her.
            </aside>
          </section>

          <section>
            <p>
              <b>Windows</b>: binæranalyse med
              <span class="fragment highlight-green">filegenskaper</span>
            </p>
            <p class="fragment">
              Ingen ledetråder så langt
            </p>
            <aside class="notes">
              På Windows kan vi gjøre det samme med
              <b>filegenskaper/Notepad</b> (NESTE)<br />
              (NESTE)<br />
              Finner ingen ledetråder med dette heller, ikke noe som stikker seg
              ut
            </aside>
          </section>

          <section>
            <p>
              <b>Linux</b>: binæranalyse med
              <span class="fragment highlight-green">binwalk</span>
            </p>
            <pre
              class="fragment fade-up"
            ><code class="shell smaller" data-trim data-noescape>
              root@c04ddcc8bccd:~# binwalk u_are_th3_winrar.jpg

              DECIMAL       HEXADECIMAL     DESCRIPTION
              --------------------------------------------------------------------------------
              0             0x0             JPEG image data, JFIF standard 1.01
              30            0x1E            TIFF image data, big-endian, offset of first image directory: 8
              66398         0x1035E         <mark class="fragment">RAR archive data</mark>, version 5.x
              2552386       0x26F242        Certificate in DER format (x509 v3), header length: 4, sequence length: 30088
            </code></pre>

            <p class="fragment">
              I ❤️ <a href="https://github.com/ReFirmLabs/binwalk">binwalk</a>
            </p>
            <p class="fragment fade-up">❤️ Open Source ❤️</p>
            <aside class="notes">
              * Vi bruker (NESTE) <b>binwalk</b> igjen for å analysere filen<br />(NESTE)<br />
              * Litt artig, det ligger også en binær sertifikatfil gjemt
              her...<br />
              * Men... (NESTE)<br />
              * vi ser at det skjuler seg en RAR-fil (WinRar) i bildet!<br />
              (NESTE)<br />
              * Jeg <b>digger binwalk</b> fordi den finner alt!<br />
              (NESTE)<br />
              * OG binwalk er Open Source, som varmer mitt Open Source-hjerte!
            </aside>
          </section>

          <section data-source="bobu_sumisu_pst_writeup">
            <p>
              Ekstraherer RAR-filen ut av <b>u_are_th3_winrar.jpg</b> med
              <span class="fragment highlight-green">dd</span> (Linux)
            </p>

            <pre
              class="fragment fade-up"
            ><code class="shell smaller" data-trim data-noescape>
              root@c04ddcc8bccd:~# dd
              if=u_are_th3_winrar.jpg \
              of=u_are_th3_winrar.rar \
              bs=1 \
              skip=66398

              8914231+0 records in
              8914231+0 records out
              8914231 bytes (8.9 MB, 8.5 MiB) copied, 11.1746 s, 798 kB/s
            </code></pre>

            <p class="fragment">
              Ny fil:
              <span class="fragment highlight-green">u_are_th3_winrar.rar</span>
            </p>
            <aside class="notes">
              * Vi trenger å plukke ut RAR-filens binærdata ut av bildet. Til
              dette bruker jeg (NESTE) <b>dd</b> <br />

              * På mange måter som å finne en sang på en gammeldags
              musikk-kassett. Vi må spole fram til dataene (sangen) som vi er
              interessert i (NESTE)<br />

              * Her ser vi at vi har plukket ut filen fra bildet og lagd en ny
              fil: (NESTE) <b>u_are_th3_winrar.rar</b> (NESTE)<br /><br />

              (ANEKDOTE)<br />
              * Å finne filer gjemt i andre filer er klassisk CTF-oppgave og med
              litt trening får man øye på sånt, og finner raskt skjulte filer
            </aside>
          </section>

          <section>
            <p>
              Vi pakker <b>u_are_th3_winrar.rar</b> med
              <span class="fragment highlight-green">WinRAR</span> på Windows
            </p>
            <p class="fragment">
              Tilsvarer <span class="fragment highlight-green">unrar</span> på
              Linux
            </p>
            <aside class="notes">
              * Vi får pakke ut hva som ligger i denne WinRar-filen<br />
              * Jeg bruker (NESTE) <b>WinRar</b> i Windows. <br />
              (NESTE)<br /><br />

              <b>Unrar</b> for Linux gjør det samme.
            </aside>
          </section>

          <section data-source="winrar">
            <img
              data-src="img/u_are_th3_winrar-jpg/u_are_th3_winrar-filer.png"
              class="plain"
            />
            <aside class="notes">
              Hva finner vi i RAR-filen?<br />
              To filer: <b>gratulerer.gif</b> og <b>gratulerer.txt</b><br />
              La oss kikke på GIF'en først.
            </aside>
          </section>

          <section
            data-source="pst"
            data-background="img/u_are_th3_winrar-jpg/u_are_th3_winrar-jpg-gratulerer.gif"
          ></section>

          <section>
            <p>Vi klarte det! 👏👏</p>
            <p class="fragment">Hva finner vi i <b>gratulerer.txt</b>?</p>
            <aside class="notes">
              Vi blir gratulert av Leo fra Great Gatsby. Ikke hverdags!
              (NESTE)<br />
              Hva finner vi i den andre filen: <b>gratulerer.txt</b>?
            </aside>
          </section>

          <section>
            <blockquote>
              Gratulerer, du har løst de oppgavene vi hadde i denne omgang. Hvis
              du har lyst på reelle utfordringer og å løse oppgaver som kan
              bidra til å utgjøre en forskjell så håper vi at du tar deg tid til
              å søke. Bruk gjerne kodeordet [FJERNET, red.anm.] i søknaden din,
              så vi vet at du har fullført challengen! Vi ser frem til å høre
              fra deg! [...]
            </blockquote>
            <aside class="notes">
              Filen gratulerer oss og oppfordrer oss til å søke på
              stillingen.<br /><br />

              Hvis vi søker så blir vi bedt om å nevne det
              <b>hemmelige kodeordet</b> som vi nå har fått tilgang til ved å
              løse oppgavene. Hva det var får du finne ut selv...<br /><br />

              Resten av filen er fyllstoff med Lorem Ipsum dummytekst.
            </aside>
          </section>
        </section>

        <!-- =================== OPPSUMMERING =================== -->
        <section>
          <section>
            <h2>Hva har vi lært?</h2>
            <aside class="notes">
              * Hvordan gjorde jeg det? <br />
              ** blindsporbokstaver til koordinater, 1 arb.dag effektivt<br />
              ** lærte meg Linux og verktøy<br /><br />

              * Lærte å skrive ned både løsning og oppgave, til evt. senere bruk
            </aside>
          </section>

          <section>
            <h3>Kodeknekking</h3>
            <p>lærerikt</p>
            <p>utfordrende</p>
            <p>tålmodighetsprøve</p>
            <p>dopamin-kick!</p>
            <aside class="notes">
              * er lærerikt<br />
              * er utfordrende<br />
              * er en skikkelig tålmodighetsprøve<br />
              * er et realt dopamin-kick når man løser noe!<br /><br />

              * Hvordan blir vi gode kodeknekkere? (Verktøy og kunnskap)<br /><br />

              La oss se på verktøyene jeg brukte til å løse gåten
            </aside>
          </section>

          <section>
            <h3>Verktøy</h3>
            <ul>
              <li class="">
                <p>
                  Steganografi og bildeanalyse:
                  <a
                    href="https://github.com/zardus/ctf-tools/blob/master/stegsolve"
                    >StegSolve</a
                  >,
                  <a href="https://stylesuxx.github.io/steganography/"
                    >Steganografi-dekoder</a
                  >,
                  <a href="https://incoherency.co.uk/image-steganography"
                    >LSB-dekoder</a
                  >
                </p>
              </li>
              <li class="">
                Binæranalyse:
                <a href="https://github.com/ReFirmLabs/binwalk">binwalk</a>,
                strings, file, dd, Sublime/Notepad
              </li>
              <li class="">
                <p>
                  Nettverksanalyse: Wireshark
                </p>
              </li>
              <li class="">
                <p>OS: Windows og Linux</p>
                <pre
                  class="fragment fade-up"
                ><code class="shell smaller" data-trim data-noescape>
                    docker run -t -i -v c:/projects:/projects \
                    kalilinux/kali-linux-docker \
                    /bin/bash
                  </code></pre>
              </li>
            </ul>
            <aside class="notes">
              Verktøyene jeg brukte på å løse PST-gåten<br />
              * StegSolve, nettsider<br />
              * binwalk, strings, file, dd, tekstverktøy<br />
              * Wireshark<br />
              * Windows + Linux<br /><br />

              * Å bruke Windows med en Virtuell maskin med Linux er ganske digg
              (ref. spesialverktøy) (NESTE)<br />
              Slik satte jeg opp Docker på Windows så jeg kunne bruke en Linux
              VM. Og Linux har her tilgang til min prosjektmappe (dele filer)<br /><br />
              Hvorfor bruker jeg Kali Linux? Google it!<br /><br />

              Så hvordan blir vi gode kodeknekkere? Vi må øve...
            </aside>
          </section>

          <section>
            <h3>Bygg kompetanse!</h3>
            <ul class="">
              <li class="">
                <a href="https://ctf.hacker101.com">Hacker101 CTF</a>
              </li>
              <li class="">
                <a href="https://19.tghack.no">TGHack</a>
              </li>
              <li class="">
                <a href="https://hackthebox.eu">Hackthebox</a>
              </li>
              <li class="">
                <a href="https://hack-yourself-first.com"
                  >hack-yourself-first.com</a
                >
              </li>
              <li class="">
                <a
                  href="https://www.owasp.org/index.php/OWASP_Juice_Shop_Project"
                  >OWASP Juice Shop</a
                >
              </li>
            </ul>
            <p class="fragment fade-in">
              Løs CTF-er som lag:<br />
              <a href="https://realworldctf.com/">Real World CTF</a>,
              <a href="https://capturetheflag.withgoogle.com/">Google CTF</a>
            </p>
            <aside class="notes">
              En glimrende måte å starte på er å løse CTF'er<br /><br />

              * HackerOne sin <b>Hacker101</b> er et supert sted å lære, kommer
              stadig nye oppgaver innen web, reverse engineering, crypto
              m.fl.<br />

              * <b>The Gathering</b> har fine oppgaver på flere kategorier, blir
              en god hacker på mye forskjellig. Veldig lærerikt!<br />

              * <b>Hackthebox</b> for deg som vil opp noen hakk i
              vanskelighetsgrad. Ofte kreves koding for å løse oppgaver, mer
              avanserte løsninger ofte<br />

              * <b>hack-yourself-first.com</b> er en åpen nettside full av
              sårbarheter, bare å hacke ivei. Troy Hunt står bak<br />

              * <b>OWASP Juice Shop</b> er perfekt hvis du vil holde en intern
              CTF-konkurranse. Jag sårbarheter, få poeng, vinn! Lagd av OWASP
              (Open Web Application Security Project).<br /><br />

              * Hvis det å være på lag og jobbe til seint på natten
              frister...(NESTE)<br /><br />

              * Hvorfor ikke delta i CTF-konkurranser, reis! (premier og
              jobb)<br />
              * Arranger CTF-konkurranser internt (sikkerhetsfokus)
            </aside>
          </section>

          <section>
            <h3>Konferanser</h3>
            <div>
              <p><a href="https://owaspnorwayday.org/">OWASP Norway Day</a></p>
              <p>
                <a href="https://sikkerhetsfestivalen.no/"
                  >Sikkerhetsfestivalen</a
                >
              </p>
              <p><a href="https://www.blackhat.com/">BlackHat</a></p>
            </div>
            <aside class="notes">
              Kompetansebygging handler også om å dele med hverandre - gå på
              konferanser eller hold foredrag<br /><br />

              * OWASP Norway Day<br />
              * Sikkerhetsfestivalen<br />
              * BlackHat (Vegas, Europa)<br /><br />

              * Er du fortsatt ikke motivert til å lære mer om kodeknekking og
              etisk hacking, etter alt du har sett idag...
              <br />
              * Hva hvis du kunne få betalt for spisskompetansen din og hjelpe
              bedrifter i å finne sårbarheter i sine tjenester?
            </aside>
          </section>

          <section>
            <h3>Bug-bounties! 🐛</h3>
            <div class="fragment fade-in">
              <p>
                Registrer deg på
                <a href="https://www.hackerone.com/">HackerOne</a> og følg
                <a href="https://twitter.com/Hacker0x01">@Hacker0x01</a>
              </p>
              <p>Les reglene og slå deg løs! 🤑</p>
            </div>
            <aside class="notes">
              Få betalt for å finne sårbarheter og bugs (NESTE)<br /><br />

              * HackerOne er en plattform for bedrifter som har
              bugbounty-programmer for sine tjenester (Twitter, Facebook
              m.fl)<br /><br />

              * Registrer deg og slå deg løs! Tjen penger!<br /><br />

              (ANEKDOTE): På HackerOnes hackaton på Black Hat-konferansen i Las
              Vegas iår ble det betalt ut et nytt rekordbeløp på $2m i
              bugbountry-premier totalt... som viser potensialet i premier og at
              bugbountry-programmer gir resultater. <br />
              Hvis Hydro, VISMA, Bitcoin Norge hadde hatt et bugbountry-program,
              ville de fortsatt ha blitt hacket? Kanskje et forslag å legge på
              bordet nå ihvertfall?<br /><br />

              Jeg tenkte å avslutte med en liten appell.
            </aside>
          </section>

          <section>
            <h3>IT-sikkerhet er alles ansvar</h3>
            <p>
              Øk sikkerhetskompetansen
            </p>
            <p>
              Prioriter sikkerhet
            </p>
            <aside class="notes">
              Avslutningsvis:<br />

              For å gjøre det vanskeligere for hackerne må vi ha det
              grunnleggende på plass<br />

              * vi må øke sikkerhetskompetansen blant oss selv, kollegar,
              familie og venner<br />
              * vi må priorite sikkerhet på lik linje med andre
              ikke-funksjonelle krav i programvaren vi lager<br /><br />

              Dette er vårt ansvar!
            </aside>
          </section>

          <section>
            <h3>Typisk norsk å være god</h3>
            <p class="fragment fade-up">
              ...også på
              <span class="fragment highlight-green">IT-sikkerhet</span>?
            </p>
            <aside class="notes">
              Vi har ikke mye å stille opp med sammenlignet med andre større
              aktørers cyber-forsvarsbudsjetter (NESTE)<br />

              Men kanskje det er typisk norsk (NESTE) å allikevel klare å ta
              igjen skjevheten med dyktighet, og at vi er effektive og
              effektfulle i det vi gjør
            </aside>
          </section>

          <section>
            <h3>La oss bygge et sikrere Norge!</h3>
          </section>

          <section>
            <p class="fragment fade-in">
              Bli en spion - <span class="fragment">søk jobb i PST 🕵️‍♂️</span>
            </p>
            <aside class="notes">
              Så hvis det høres fristende ut å være en
              <b>kodeknekker</b> - gi deg selv en utfordring! <br />

              * Bli en <b>etisk hacker</b> og gjør det til en hobby eller
              jobb<br /><br />

              * Eventuelt, hvis du er god nok, hvorfor ikke vurdere å bli en
              spion? (NESTE)<br /><br />

              * Jeg hører de ser etter folk hos PST
            </aside>
          </section>
        </section>

        <!-- =================== TAKK =================== -->
        <section data-transition="concave">
          <h2>Takk!</h2>
          <br />
          <div class="columns">
            <div class="col">
              <div
                class="qrcode"
                align="center"
                title="https://henrikwm.github.io/kodeknekking_for_spioner"
              ></div>
              <div class="half-size"><a class="qrcode-link"></a></div>
            </div>
            <div class="col">
              <img
                src="img/oppsummering/oppsummering-takk2.png"
                class="plain"
                style="width: 50%"
              />
            </div>
          </div>
          <br />
          <p>
            <a href="mailto:henrik.walker.moe@bekk.no"
              >henrik.walker.moe@bekk.no</a
            >
          </p>

          <aside class="notes">
            * Det var alt jeg hadde for idag. Tusen takk for at dere kom og
            hørte på. <br /><br />

            * Ha en flott JavaZone videre!<br /><br />

            * Takk for meg!
          </aside>
        </section>
      </div>
    </div>

    <script src="js/reveal.min.js"></script>

    <!-- Reveal-listeners -->
    <script type="text/javascript" async defer>
      // Sources
      var sources = {
        background_image: "Foto: iStock.com, rami_hakala",
        bitmoji: "Bitmoji Avatar Ⓒ Snap Group Limited",
        henrikwm: "Kilde: Henrik Walker Moe, Lisens: CC BY 4.0",
        skattejakten_bokelskere:
          "Kilde: https://bokelskere.no/bok/skattejakten/158227/, Foto: Bladkompaniet",
        abcnyheter_hydro:
          "Kilde: https://www.abcnyheter.no/nyheter/norge/2019/03/20/195562644/etterforskere-ser-til-utlandet-etter-dataangrepet-mot-hydro, Foto: abcnyheter.no",
        dagbladet_pst:
          "Kilde: https://www.dagbladet.no/nyheter/pst-fjernet-hai-fra-twitter-feeden/70377787, Foto: Dagbladet",
        stillingsannonsen_nrk:
          "Kilde: https://www.nrk.no/norge/pst-ber-jobbsokarar-loyse-gate-i-jobbannonse-1.14371000, Foto: NRK",
        pst: "Kilde: PST",
        roy_solberg_fra_pst: "Kilde: Roy Solberg, Foto: PST",
        twitterhai_eu_domaintools:
          "Kilde: http://reverseip.domaintools.com/search/?q=twitterhai.eu, Foto: Domaintools",
        roy_solberg: "Kilde: Roy Solberg, Foto: Twitter",
        stegsolve_caesum: "Foto: StegSolve, Caesum, Windows 10",
        roy_solberg_blogg:
          "Kilde: https://blog.roysolberg.com/2019/01/pst-challenge",
        twitter: "Kilde: https://twitter.com/twitt3rhai, Foto: Twitter",
        joshua_reynolds:
          "Foto: https://en.wikipedia.org/wiki/File:Samuel_Johnson_by_Joshua_Reynolds_2.png, Lisens: CC BY-SA",
        exif_regex_info: "Kilde: http://exif.regex.info/exif.cgi",
        ceasar_wheel:
          "Foto: https://commons.wikimedia.org/wiki/File:CipherDisk2000.jpg, Lisens: Public",
        ceasar_cipher_decryption_tool:
          "Kilde: https://www.xarg.org/tools/caesar-cipher",
        wireshark: "Foto: Wireshark, Windows 10",
        windows10: "Foto: Windows 10",
        snl_runer:
          "Kilde: Heyerdahl, Gerd Høst. (2019, 30. mai). runer. I Store norske leksikon. Hentet 25. august 2019 fra https://snl.no/runer",
        zxing_decode: "Kilde: https://zxing.org/w/decode",
        incoherency_image_steganografi:
          "Kilde: https://incoherency.co.uk/image-steganography",
        georgeom_stegonline: "Kilde: https://georgeom.net/StegOnline/extract",
        bobu_sumisu_pst_writeup:
          "Kilde: https://gist.github.com/BobuSumisu/501dafd4d7166d2a295a68c20bc3eb41",
        winrar: "Foto: WinRAR, Windows 10"
      };

      function setFooterSource() {
        var currentSlide = Reveal.getCurrentSlide();

        var footer = document.getElementById("title-footer");
        if (footer) {
          footer.parentNode.removeChild(footer);
        }

        var source = currentSlide.getAttribute("data-source");
        if (source !== null) {
          title_footer.initialize(sources[source]);
        }
      }

      Reveal.addEventListener("ready", function(event) {
        setFooterSource();
      });

      Reveal.addEventListener(
        "slidechanged",
        function() {
          setFooterSource();
        },
        false
      );

      var twitterhai_pwd_letter_1 = "H";
      var twitterhai_pwd_letter_2 = "HA";
      var twitterhai_pwd_letter_3 = "HAI";
      var twitterhai_pwd_letter_4 = "HAI1";
      var twitterhai_pwd_letter_5 = "HAI13";
      var twitterhai_pwd_letter_6 = "HAI133";
      var twitterhai_pwd_letter_7 = "HAI1337 🦈";

      // prettier-ignore
      var twitterhai_pwd_1 =
        "Tigerhai HvithaiHammerhaiHvalhai Oksehai Domenehai Brugde\n\
Brugde DomenehaiTigerhaiHvithai Hvalhai Hammerhai Oksehai\n\
HammerhaiJaws   Fish   Hvalhai Oksehai Domenehai Tigerhai\n\
HvithaiHaiene   Tail   Tigerhai DomenehaiBrugde Hammerhai\n\
HåbrannBrugde   Fins   HammerhaiBrugde HvithaiHvalhaiJaws\n\
HvithaiHammer          Domenehai Tigerhai Oksehai Hvalhai\n\
DomenehaiJaws   Mako   HåbrannHvithai HvalhaiTigerhaiMako\n\
BrugdeOksehai   Apex   Tigerhai HvalhaiDomenehaiHammerhai\n\
HvithaiBrugde   Jaws   HammerhaiOksehai BrugdeTigerhaiHai\n\
Brugde HvalhaiHvithaiDomenehai Oksehai Tigerhai Hammerhai\n";

      // prettier-ignore
      var twitterhai_pwd_2 =
"TigerhaiHvithaiOksehai BrugdeHammerhaiHvalhaiDomenehaiHai\n\
HvithaiHvalhai   BrugdeOksehaiDomenehai HammerhaiTigerhai\n\
HvithaiSjøen   H   TigerhaiOksehai DomenehaiHvalhaiBrugde\n\
Hammerhaien   Hai   Domenehai HvalhaiBrugdeHvithaiOksehai\n\
HvithaiHai           DomenehaiHvalhai Hammerhai Oksehaien\n\
HvithaiHai   Havet   Oksehai TigerhaiHvalhaiDomenehaiApex\n\
OksehaiHai   Sjøen   HvalhaiBrugde HvithaiHammerhaiBrugde\n\
BrugdeJaws   Finne   Brugde HvithaiHvalhaiTigerhai Haiene\n\
HammerhaiDomenehaiBrugdeOksehaiTigerhai HvalhaiHvithaiHai\n";

      // prettier-ignore
      var twitterhai_pwd_3 =
        "HvalhaiBrugdeTigerhaiHammerhaiHvithai Oksehai Domenehaien\n\
Domenehaier           OksehaiHvithai HammerhaiHvalhai Hai\n\
OksehaiTigerhai   HvalhaiDomenehaiHammerhai BrugdeHvithai\n\
DomenehaiBrugde   TigerhaiHammerhai HvithaiHvalhaiOksehai\n\
BrugdeHvithaien   HammerhaiDomenehaiHvalhai Tigerhai Mako\n\
TigerhaiHvalhai   BrugdeDomenehaiHvithai OksehaiHammerhai\n\
BrugdeOksehaien   HammerhaiHvalhaiDomenehai HvithaiBrugde\n\
HvithaiJaws           HaiHvalhaiHammerhai BrugdeDomenehai\n\
DomenehaiTigerhaiHammerhaiHvithaiBrugdeOksehai HvalhaiHai\n";

      // prettier-ignore
      var twitterhai_pwd_4 =
        "TigerhaiHvithaiBrugdeHvalhaiOksehai Domenehai Hammerhaien\n\
BrugdeTigerhaiHammerhai   DomenehaiHvalhai OksehaiHvithai\n\
DomenehaiOksehaiSjøen     HammerhaiHvalhaiTigerhaiHåbrann\n\
Hammerhai HvithaiBrugde   OksehaiHvalhai BrugdeTigerhaien\n\
HvithaiBrugdeOksehaiHai   TigerhaiDomenehai HvalhaiBrugde\n\
HvalhaiOksehaiDomenehai   TigerhaiBrugde HammerhaiHvithai\n\
Tigerhai HvithaiOksehai   HammerhaiDomenehaiBrugdeHvalhai\n\
HvithaiOksehaiBrugde         Hammerhai Tigerhai Domenehai\n\
HvalhaiHammerhaiHvithaiBrugdeTigerhai OksehaiDomenehaiHai\n";

      // prettier-ignore
      var twitterhai_pwd_5 =
        "DomenehaiHvithaiBrugdeTigerhaiHammerhai Hvalhai Oksehaien\n\
OksehaiBrugdeBrugde         Hvithai DomenehaiTigerhaiApex\n\
HvalhaiHvithaiJaws   Haier   DomenehaiHammerhaiTigerhaien\n\
TigerhaiBrugdeOksehaiSjøen   Domenehai HvalhaiHammerhaien\n\
DomenehaiHammerhaiHavet     BrugdeOksehai HvithaiTigerhai\n\
HvalhaiHammerhaiHvithaiHai   Brugde Oksehaien Domenehaien\n\
DomenehaiBrugdeHai   Havet   Hammerhai Hvalhai Tigerhaien\n\
HvalhaiOksehaiBrugde        BrugdeDomenehaiTigerhaiBrugde\n\
Hvithai DomenehaiBrugdeHammerhaiTigerhaiHvalhai Oksehaien\n";

      // prettier-ignore
      var twitterhai_pwd_6 =
        "HvalhaiBrugdeHvithaiDomenehaiOksehai Tigerhai Hammerhaien\n\
BrugdeHvithaiBrugde         HammerhaiTigerhaiHvalhaiSjøen\n\
Domenehai Tigerhai   Sjøen   HvithaiHammerhai Brugde Jaws\n\
OksehaiBrugdeHvalhaiHvitha   Domenehai Tigerhai Hammerhai\n\
TigerhaiHammerhaiHavet     HvalhaiHvithai BrugdeDomenehai\n\
TigerhaiDomenehaiHammerhai   Hvalhai HvithaiOksehaiBrugde\n\
HvithaiDomenehaien   Finne   HammerhaiHvalhaiBrugdeBrugde\n\
BrugdeOksehaiBrugden        Hammerhai Hvithai Domenehaien\n\
HvithaiBrugde TigerhaiOksehaiDomenehaiHammerhai Hvalhaien\n";

      // prettier-ignore
      var twitterhai_pwd_7 =
        "DomenehaiHammerhaiOksehaiHvithaiHvalhai Brugde Tigerhaien\n\
HammerhaiTigerhai           DomenehaiHvithaiBrugdeHvalhai\n\
HvalhaiBrugdeHvit   Haier   OksehaiTigerhai Domenehai Hai\n\
OksehaiBrugdeHvithaiJaws   HavetDomenehai TigerhaiHvalhai\n\
DomenehaiHvithaiHåbrann   Hammerhai Brugde OksehaiHvalhai\n\
DomenehaiHvalhaiBrugde   OksehaiBrugdeHammerhai Hvithaien\n\
DomenehaiTigerhaiApex   Hammerhai Hvithai Hvalhai Oksehai\n\
OksehaiHammerhaiJaws   DomenehaiTigerhaiBrugdeHvalhaiJaws\n\
Hvalhai HvithaiTigerhaiDomenehaiBrugdeHammerhai Oksehaien\n\
Håbrann TigerhaiOksehaiHvithaiBrugdeHvalhaiHammerhaiHavet\n";

      var twitterhaiTextWriter = function(
        target,
        message,
        passwordText,
        index,
        interval,
        resolve
      ) {
        if (index < message.length) {
          var element = document.getElementById(target);
          element.innerHTML += message[index++];

          window.dispatchEvent(new Event("resize"));

          element.scrollTop = element.scrollHeight;

          setTimeout(function() {
            twitterhaiTextWriter(
              target,
              message,
              passwordText,
              index,
              interval,
              resolve
            );
          }, interval);
        }

        if (index === message.length) {
          var element = document.getElementById(target + "-password");
          element.innerHTML = passwordText;

          if (resolve !== undefined) resolve();
        }
      };

      Reveal.addEventListener("stillingsannonsen-scrambler-start", function() {
        // Scrambler
        Scrambler({
          target: "#scramble-id",
          random: [1000, 12000],
          speed: 100,
          text: "TWITTERHAI.EU",
          beforeEach: function(element) {
            console.log("About to scramble");
          },
          afterAll: function(elements) {
            console.log("all done!");
          }
        });
      });

      Reveal.addEventListener("twitt3rhai-textwriter-start", function() {
        var element = document.getElementById("twitt3rhai-textwriter-target");
        element.innerHTML = "";

        var twitterhaiPromise = new Promise(function(resolve, reject) {
          twitterhaiTextWriter(
            "twitt3rhai-textwriter-target",
            twitterhai_pwd_1,
            twitterhai_pwd_letter_1,
            0,
            isProd ? 10 : 1,
            resolve
          );
        });

        twitterhaiPromise
          .then(function(result) {
            return new Promise(function(resolve, reject) {
              twitterhaiTextWriter(
                "twitt3rhai-textwriter-target",
                twitterhai_pwd_2,
                twitterhai_pwd_letter_2,
                0,
                isProd ? 6 : 1,
                resolve
              );
            });
          })
          .then(function(result) {
            return new Promise(function(resolve, reject) {
              twitterhaiTextWriter(
                "twitt3rhai-textwriter-target",
                twitterhai_pwd_3,
                twitterhai_pwd_letter_3,
                0,
                isProd ? 1 : 1,
                resolve
              );
            });
          })
          .then(function(result) {
            return new Promise(function(resolve, reject) {
              twitterhaiTextWriter(
                "twitt3rhai-textwriter-target",
                twitterhai_pwd_4,
                twitterhai_pwd_letter_4,
                0,
                isProd ? 1 : 1,
                resolve
              );
            });
          })
          .then(function(result) {
            return new Promise(function(resolve, reject) {
              twitterhaiTextWriter(
                "twitt3rhai-textwriter-target",
                twitterhai_pwd_5,
                twitterhai_pwd_letter_5,
                0,
                isProd ? 1 : 1,
                resolve
              );
            });
          })
          .then(function(result) {
            return new Promise(function(resolve, reject) {
              twitterhaiTextWriter(
                "twitt3rhai-textwriter-target",
                twitterhai_pwd_6,
                twitterhai_pwd_letter_6,
                0,
                isProd ? 1 : 1,
                resolve
              );
            });
          })
          .then(function(result) {
            return new Promise(function(resolve, reject) {
              twitterhaiTextWriter(
                "twitt3rhai-textwriter-target",
                twitterhai_pwd_7,
                twitterhai_pwd_letter_7,
                0,
                isProd ? 1 : 1,
                resolve
              );
            });
          });
      });
    </script>

    <!-- QR Codes -->
    <script type="text/javascript">
      // Get presentation URL
      var qrcode_url = "https://henrikwm.github.io/kodeknekking_for_spioner";

      // Generate QR Codes : class="qrcode"
      var qrcode_elements = document.getElementsByClassName("qrcode");
      for (var i = 0; i < qrcode_elements.length; i++) {
        var qrcode_el = qrcode_elements[i];

        var qrcode = new QRCode(qrcode_el, {
          text: qrcode_url,
          width: 250,
          height: 250
        });

        // Alter generated image
        var img_el = qrcode._el.childNodes[1];
        img_el.classList.add("plain"); // remove border
      }

      // Add text to links : class="qrcode-link"
      var qrcode_link_elements = document.getElementsByClassName("qrcode-link");
      for (var i = 0; i < qrcode_link_elements.length; i++) {
        var link_el = qrcode_link_elements[i];
        link_el.textContent = qrcode_url;
        link_el.href = qrcode_url;
      }
    </script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        controls: true,
        progress: true,
        center: true,
        hash: true,
        history: true,

        navigationMode: "linear",

        // 1,4 vs 1,3
        // width: 1300,
        // height: 900,

        transition: "default", // none/fade/slide/convex/concave/zoom

        // Parallax scrolling
        //background: "#28306a",
        parallaxBackgroundImage: "img/background_bond2.png",
        parallaxBackgroundSize: "3700px 1600px",

        dependencies: [
          // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
          {
            src: "lib/js/classList.js",
            condition: function() {
              return !document.body.classList;
            }
          },

          // Interpret Markdown in <section> elements
          {
            src: "plugin/markdown/marked.js",
            condition: function() {
              return !!document.querySelector("[data-markdown]");
            }
          },
          {
            src: "plugin/markdown/markdown.js",
            condition: function() {
              return !!document.querySelector("[data-markdown]");
            }
          },

          // Syntax highlight for <code> elements
          { src: "plugin/highlight/highlight.js", async: true },

          { src: "plugin/search/search.js", async: true },

          // Speaker notes
          { src: "plugin/notes/notes.js", async: true },

          // Zoom in and out with Alt+click
          { src: "plugin/zoom-js/zoom.js", async: true },

          // Title-Footer plugin
          { src: "plugin/title-footer/title-footer.js" }
        ]
      });
    </script>

    <script src="//localhost:35729/livereload.js"></script>
  </body>
</html>
